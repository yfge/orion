---
id: 2025-10-16T03-52-46Z-wechat-oa-api
date: 2025-10-16T03:52:46Z
participants: [human, orion-assistant]
models: [gpt-5-codex]
tags: [backend, api]
related_paths:
  - backend/app/api/v1/notifications.py
  - backend/app/api/v1/router.py
  - backend/app/schemas/wechat_official_account.py
  - docs/architecture/channels/wechat-official-account.md
summary: "新增公众号通知 API 与 Schema"
---

## User original prompt and requirements
- 按 Task 6 需要在 schemas 层补充公众号消息请求/响应模型，并在 API 层提供创建、查询、重试接口。

## Background and goals
- 让外部系统通过标准化接口触发公众号模板消息发送，并可查询或手动重试，保持与 gateway/service 层的一致性。

## Changes
- 新建 `backend/app/schemas/wechat_official_account.py` 定义模板消息、客服消息请求体与通知返回模型，支持 alias 与示例。
- 新增 FastAPI 路由 `backend/app/api/v1/notifications.py`，实现模板消息发送、按 message_bid 查询与重试，调用 `WechatGatewayService` 并落库。
- 将路由挂载到 `api/v1/router.py`，并在架构文档补充 API 设计章节，说明各端点职责与扩展计划。

## Outcome and impact
- API 层具备公众号消息管理能力，前后端可复用统一 Schema；结合 gateway/service，可在后续接入实际队列与回调联动。

## Next steps (TODO)
- 扩展列表查询、客服消息补发接口，以及与 send_record/任务队列的联动。
- 更新文档中的 OpenAPI 示例与权限说明。

## Linked commits/PRs
- feat(api): expose wechat notification endpoints
