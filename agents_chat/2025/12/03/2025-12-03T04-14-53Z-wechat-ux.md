---
id: 2025-12-03T04-14-53Z-wechat-ux
date: 2025-12-03T04:14:53Z
participants: [human, orion-assistant]
models: [gpt-4o]
tags: [frontend, wechat, ux]
related_paths:
  - frontend/app/messages/new/page.tsx
  - frontend/app/messages/[bid]/page.tsx
  - frontend/app/systems/[bid]/endpoints/[endpointBid]/page.tsx
  - frontend/lib/api.ts
  - tasks.md
summary: "提升微信消息易用性：快捷模板、校验提示、映射示例、测试入口"
---

## User original prompt and requirements
- "如何能让微信消息功能更易用一些？" 希望从快捷模板、预览校验、映射向导、发送测试等方面改进。
- 后续要求将方案列入 tasks.md，并使用复选框标记状态，再实现全部事项并保持提交原子性。

## Background and goals
- 现有 UI 创建微信消息和配置映射时需手写 JSON，易错且缺少即时反馈。
- 目标：提供微信消息的快速模板、实时校验提示、映射示例、一键测试发送，降低试错成本。

## Changes
- frontend/app/messages/new/page.tsx、frontend/app/messages/[bid]/page.tsx：
  - 增加微信模板/小程序跳转、客服文本/图片等快捷模板按钮，自动填充 schema 与示例数据。
  - 新增 schema/示例 JSON 解析错误提示与缺失必填字段提示，预览表单使用解析后的 schema 防止错误阻塞。
- frontend/app/systems/[bid]/endpoints/[endpointBid]/page.tsx：
  - dispatch 区域新增「微信模板映射示例」一键填充 touser/template_id/data/link。
  - 渠道为微信时提供测试发送表单（OpenID、模板 ID、first/remark、URL、可选 AppID），调用 `/api/v1/notifications/wechat/template` 返回结果/errcode。
- frontend/lib/api.ts：增加 sendWechatTemplateTest API 封装。
- tasks.md：将微信易用性提升相关子任务标记为已完成。

## Outcome and impact
- 创建/编辑微信消息时可直接套用模板并看到即时解析/缺失提示，减少 JSON 书写和校验成本。
- 端点映射可一键生成微信模板字段，降低遗漏关键字段风险。
- 提供微信专用测试发送入口，便于验证渠道配置与模板参数，结果直接展示。

## Next steps (TODO)
- 如果微信模板所需字段更多（如多 data 字段），可增加可视化字段编辑器。
- 在消息定义/端点页面联动展示引用的模板 ID 列表或历史测试记录。
- 可考虑为客服消息增加富媒体预览（图片/卡片）。

## Linked commits/PRs
- 未提交 commit
